import{a,I as T,_ as H,r as y,u as O,ab as M,ac as d,j as e,C as N,ad as V,B as h,ag as k,P as A,s as f}from"./index-DrQQ5ErI.js";import{F as B,i as C,T as j}from"./error-CthvLBzb.js";import{S as E}from"./index-yP4FQ8gW.js";var L={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M608 192a32 32 0 0132 32v160h174.81a32 32 0 0126.68 14.33l113.19 170.84a32 32 0 015.32 17.68V672a32 32 0 01-32 32h-96c0 70.7-57.3 128-128 128s-128-57.3-128-128H384c0 70.7-57.3 128-128 128s-128-57.3-128-128H96a32 32 0 01-32-32V224a32 32 0 0132-32zM256 640a64 64 0 000 128h1.06A64 64 0 00256 640m448 0a64 64 0 000 128h1.06A64 64 0 00704 640M576 256H128v384h17.12c22.13-38.26 63.5-64 110.88-64 47.38 0 88.75 25.74 110.88 64H576zm221.63 192H640v145.12A127.43 127.43 0 01704 576c47.38 0 88.75 25.74 110.88 64H896v-43.52zM500 448a12 12 0 0112 12v40a12 12 0 01-12 12H332a12 12 0 01-12-12v-40a12 12 0 0112-12zM308 320a12 12 0 0112 12v40a12 12 0 01-12 12H204a12 12 0 01-12-12v-40a12 12 0 0112-12z"}}]},name:"truck",theme:"outlined"},R=function(i,o){return a.createElement(T,H({},i,{ref:o,icon:L}))},v=a.forwardRef(R);function $(t){return y({url:"order/getOrderListBySeller",method:"POST",data:t})}function _(t){return y({url:"order/delivery",method:"POST",data:t})}const G=()=>{const t={2:e.jsx(j,{color:"warning",children:"未发货"}),3:e.jsx(j,{color:"success",children:"已完成"})},i=[{title:"订单号",dataIndex:"id"},{title:"封面",dataIndex:"images",width:100,render:s=>e.jsx("img",{src:`http://8.134.124.55:80/post/uploads/${s[0]}`||C,width:60,height:60,alt:""})},{title:"商品名",dataIndex:"goodsName",width:200},{title:"用户名",dataIndex:"userName"},{title:"数量",dataIndex:"number"},{title:"交易时间",dataIndex:"time"},{title:"状态",dataIndex:"status",render:s=>t[s]},{title:"发货",render:s=>e.jsx(E,{size:"middle",children:s.status===2?e.jsx(A,{content:"点击发货",placement:"top",children:e.jsx(h,{type:"primary",shape:"circle",disabled:s.status===3,icon:e.jsx(v,{}),onClick:()=>P(s.id)})}):e.jsx(h,{type:"primary",shape:"circle",disabled:!0,icon:e.jsx(v,{})})})}],[o,p]=a.useState([]),[S,w]=a.useState(0),c=O(s=>s.user.userInfo.id),[b]=M(),l=b.get("goodsId"),[r,x]=a.useState({role:2,pageSize:10,pageNum:1,type:l?"goods":"seller",search:l||c});a.useEffect(()=>{async function s(){const u=await $(r);p(u.data.list),w(u.data.total)}s()},[r]);const P=async s=>{const I=await _({orderId:s,sellerId:c});if(I.status===200){f.success("该订单已发货");const F=o.map(m=>m.id===s?{...m,status:3}:m);p(F)}else f.error(I.desc)},[n]=d.useForm(),g=()=>{if(!n.getFieldValue("goodsId"))return z();x({...r,search:n.getFieldValue("goodsId"),type:"goods"})},z=()=>{n.setFieldValue("goodsId",""),x({...r,search:c,type:"seller"})};return e.jsx("div",{children:e.jsxs(N,{title:"订单列表",style:{marginBottom:20},children:[e.jsx(d,{initialValues:{},form:n,onFinish:g,children:e.jsxs("div",{className:"search-box",children:[e.jsx(d.Item,{label:"按商品查询",name:"goodsId",children:e.jsx(V,{className:"search",placeholder:"输入商品id",allowClear:!0,onPressEnter:g})}),e.jsx(d.Item,{children:e.jsx(h,{type:"primary",htmlType:"submit",icon:e.jsx(k,{}),shape:"circle",className:"but"})})]})}),e.jsx(B,{rowKey:"id",columns:i,dataSource:o,pagination:{total:S,pageSize:r.pageSize}})]})})};export{G as default};
